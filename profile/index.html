<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Listing | Auksjonshuset</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="/images/greek-pillar(header+favicon).png"
    />
    <script
      src="https://kit.fontawesome.com/d75c3894ae.js"
      crossorigin="anonymous"
    ></script>
    <script type="module" src="/src/main.js"></script>
  </head>
  <body data-page="profile">
    <!-- Header -->
    <header class="py-2">
      <div class="container d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <a class="navbar-brand" href="/">
            <img
              src="/images/greek-pillar(header+favicon).png"
              alt="Auksjonshuset logo"
            />
          </a>
          <h1 class="mb-0">
            <a href="/" class="text-decoration-none logo-text">Auksjonshuset</a>
          </h1>
        </div>

        <!-- Search Bar -->
        <form
          class="d-flex position-relative search-form"
          role="search"
          id="searchForm"
        >
          <input
            class="form-control"
            type="search"
            placeholder="Search"
            aria-label="Search"
            id="searchInput"
          />
          <div id="searchResults" class="search-results"></div>
        </form>

        <!-- Right side (Login/Sign-up or Profile/Logout) -->
        <div class="header-buttons d-flex align-items-center">
          <!-- When not logged in -->
          <button
            class="btn btn-primary me-2 header-login-btn"
            data-action="login"
          >
            Login
          </button>
          <button
            class="btn btn-secondary header-register-btn"
            data-action="register"
          >
            Sign Up
          </button>

          <!-- When logged in, visible on large screens -->
          <div id="user-info" class="d-none align-items-center ms-3">
            <a href="/profile/">
              <img
                id="user-avatar"
                src=""
                alt="User Avatar"
                class="rounded-circle me-2"
                style="width: 40px; height: 40px; object-fit: cover"
              />
            </a>
            <a href="/profile/" style="text-decoration: none; color: #eaeaea">
              <div class="me-3">
                <span id="user-name" class="fw-bold"></span>
              </div>
            </a>
            <div class="me-3">
              <i class="fa-solid fa-wallet"></i> <span id="user-credits"></span>
            </div>
            <button id="create-button" class="d-none btn btn-primary me-2">
              Create
            </button>
            <button id="logout" class="logout-btn btn btn-outline-danger">
              Logout
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main content of the page -->
    <main id="main-profile" class="container my-4">
      <section id="profile">
        <!-- Profile content will be dynamically injected here -->
      </section>

      <h2 class="mb-4">Listings by user</h2>

      <section
        id="user-listings"
        class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4"
      >
        <!-- The user's listings will be dynamically injected here -->
      </section>

      <hr class="my-5" />

      <h2>Update Profile</h2>
      <form id="updateProfileForm">
        <div class="mb-3">
          <label for="profileBio" class="form-label">Bio</label>
          <textarea
            id="profileBio"
            class="form-control"
            rows="3"
            placeholder="Enter your new bio..."
          ></textarea>
        </div>

        <div class="mb-3">
          <label for="profileAvatarUrl" class="form-label">Avatar URL</label>
          <input
            type="url"
            id="profileAvatarUrl"
            class="form-control"
            placeholder="https://example.com/avatar.jpg"
          />
        </div>

        <div class="mb-3">
          <label for="profileBannerUrl" class="form-label">Banner URL</label>
          <input
            type="url"
            id="profileBannerUrl"
            class="form-control"
            placeholder="https://example.com/banner.jpg"
          />
        </div>

        <button type="submit" class="btn btn-success">Update Profile</button>
      </form>
    </main>

    <!-- Normal footer for large screens -->
    <footer class="site-footer d-none d-lg-block my-3">
      <hr />
      <div class="footer-text text-center py-2">&copy; Auksjonshuset</div>
    </footer>

    <!-- Footer (Sticky) -->
    <footer class="sticky-footer">
      <div
        class="container d-flex justify-content-between align-items-center py-2"
      >
        <a
          href="/"
          class="btn btn-outline-secondary footer-btn d-flex flex-column align-items-center"
        >
          <i class="fa-solid fa-home"></i>
          <small>Home</small>
        </a>

        <a
          href="/listing/create/"
          class="btn btn-outline-secondary footer-btn d-flex flex-column align-items-center"
        >
          <i class="fa-solid fa-plus"></i>
          <small>Create</small>
        </a>

        <!-- On smaller screens, show wallet balance here if logged in -->
        <div
          id="footer-balance"
          class="d-none d-lg-none d-flex flex-column footer-btn align-items-center ms-3"
        >
          <i class="fa-solid fa-wallet"></i>
          <small id="footer-user-credits"></small>
        </div>

        <!-- "More" menu toggle -->
        <button
          class="btn btn-outline-secondary footer-btn d-flex flex-column align-items-center"
          type="button"
          data-action="toggle-sidebar"
          aria-controls="offcanvasSidebar"
        >
          <i class="fa-solid fa-bars"></i>
          <small>More</small>
        </button>
      </div>
    </footer>

    <!-- Offcanvas Sidebar -->
    <div
      class="offcanvas offcanvas-start sidebar"
      tabindex="-1"
      id="offcanvasSidebar"
      aria-labelledby="offcanvasSidebarLabel"
    >
      <div class="offcanvas-header" data-bs-theme="dark">
        <button
          type="button"
          class="btn-close sidebar-close"
          data-bs-dismiss="offcanvas"
          aria-label="Close"
        ></button>
      </div>
      <div class="offcanvas-body">
        <!-- Profile Section (when logged in) -->
        <div
          id="sidebar-profile"
          class="d-none p-3 rounded-3"
          style="background: #666"
        >
          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center">
              <img
                id="sidebar-user-avatar"
                src=""
                alt="User Avatar"
                class="rounded-circle me-3"
                style="width: 50px; height: 50px; object-fit: cover"
              />
              <div>
                <span id="sidebar-user-name" class="text-white fw-bold"
                  >Name</span
                ><br />
                <span id="sidebar-user-credits" class="text-white-50">$0</span>
              </div>
            </div>
            <!-- Gear icon or logout could go here if desired, but we have logout below -->
            <a href="/profile/">
              <i class="fa-solid fa-gear text-white"></i>
            </a>
          </div>
        </div>

        <ul class="navbar-nav mt-3">
          <!--
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          ... other nav items ... 
        -->

          <!-- When not logged in -->
          <li class="nav-item" id="sidebar-login-btn-container">
            <button class="btn btn-primary w-100 my-2" data-action="login">
              Login
            </button>
          </li>
          <li class="nav-item" id="sidebar-register-btn-container">
            <button class="btn btn-secondary w-100" data-action="register">
              Sign Up
            </button>
          </li>

          <!-- When logged in (show logout here on smaller screens) -->
          <li class="nav-item d-none" id="sidebar-logout-container">
            <button
              id="sidebar-logout"
              class="logout-btn btn btn-outline-danger w-100 my-2"
            >
              Logout
            </button>
          </li>
        </ul>
      </div>
    </div>

    <!-- Login Modal -->
    <div
      class="modal fade"
      id="loginModal"
      tabindex="-1"
      aria-labelledby="loginModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Login</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="loginForm">
              <div class="mb-3">
                <label for="loginEmail" class="form-label">Email address</label>
                <input
                  type="email"
                  class="form-control"
                  id="loginEmail"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="loginPassword" class="form-label">Password</label>
                <input
                  type="password"
                  class="form-control"
                  id="loginPassword"
                  required
                />
              </div>
              <div class="d-grid mb-3">
                <button type="submit" class="btn btn-primary">Login</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Register Modal -->
    <div
      class="modal fade"
      id="registerModal"
      tabindex="-1"
      aria-labelledby="registerModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="registerModalLabel">Sign Up</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form
              id="registerForm"
              name="register"
              class="needs-validation"
              novalidate
            >
              <!-- Name Field -->
              <div class="mb-3">
                <label for="registerName" class="form-label">Name</label>
                <input
                  id="registerName"
                  type="text"
                  name="name"
                  class="form-control"
                  required
                />
                <div class="invalid-feedback">Please enter your name.</div>
              </div>
              <!-- Email Field -->
              <div class="mb-3">
                <label for="registerEmail" class="form-label">Email</label>
                <input
                  id="registerEmail"
                  type="email"
                  name="email"
                  class="form-control"
                  required
                  pattern="^[\w\-.]+@(stud\.)?noroff\.no$"
                  title="Please enter a valid noroff.no or stud.noroff.no email address"
                />
                <div class="invalid-feedback">
                  Please enter a valid Noroff email address.
                </div>
              </div>
              <!-- Password Field -->
              <div class="mb-3">
                <label for="registerPassword" class="form-label"
                  >Password</label
                >
                <input
                  id="registerPassword"
                  type="password"
                  name="password"
                  class="form-control"
                  required
                  minlength="8"
                />
                <div class="invalid-feedback">
                  Please enter a password with at least 8 characters.
                </div>
              </div>
              <!-- Confirm Password Field -->
              <div class="mb-3">
                <label for="registerConfirmPassword" class="form-label"
                  >Confirm Password</label
                >
                <input
                  id="registerConfirmPassword"
                  type="password"
                  name="confirmPassword"
                  class="form-control"
                  required
                  minlength="8"
                />
                <div class="invalid-feedback">
                  Please confirm your password.
                </div>
              </div>
              <!-- Register Button -->
              <div class="d-grid mb-3">
                <button type="submit" class="btn btn-secondary">Sign Up</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
